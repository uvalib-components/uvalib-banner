<link rel="import" href="../uvalib-theme/uvalib-ui-element.html">
<link rel="import" href="../uvalib-theme/uvalib-theme.html">
<link rel="import" href="../uva-models/uva-library.html">
<link rel="import" href="../iron-swiper/iron-swiper.html">
<link rel="import" href="../iron-image/iron-image.html">
<link rel="import" href="uvalib-banner.html">

<dom-module id="uvalib-banners">
  <template>
    <custom-style>
      <style include="uvalib-theme">
        :host {
          display: block;
          width: 100%;
          height: 100%;
          overflow: hidden;
          position: relative;
        }

        iron-swiper#main {
          width: 100%;
          height: 100%;
        }
        iron-swiper#thumbs {
          --iron-swiper-slide-active: {
            opacity: .3;
          };
          height: 50px;
          width: 100%;
          position: relative;
          top: -50px;
          --iron-swiper-container: {
            background-color: rgba(0,0,0,0.4);
          };
          --iron-swiper-button-prev: { color:white !important; };
          --iron-swiper-button-next: { color: white !important; };

          .swiper-slide {
              opacity: .1;
          }


        }
      </style>
    </custom-style>
    <uva-library path="web/banners" last-response="{{banners}}"></uva-library>

    <iron-swiper a11y id="main" selected="{{selected}}">
      <template is="dom-repeat" items="[[banners]]" as="banner">
        <div>
          <uvalib-banner obj$="[[banner]]" small-screen$="[[smallScreen]]" medium-screen$="[[mediumScreen]]" large-screen$="[[largeScreen]]"></uvalib-banner>
        </div>
      </template>
    </iron-swiper>

    <template is="dom-if" if="[[_showThumbs(smallScreen, banners)]]">
      <iron-swiper a11y id="thumbs" selected="{{selected}}" touch-ratio="0.2" slide-to-clicked-slide centered-slides navigation-buttons options='{"slidesPerView":5,"centeredSlides":true,"spaceBetween":10}'>
        <template is="dom-repeat" items="[[banners]]" as="banner">
          <iron-image src$="[[banner.phoneImage.url]]" alt$="Thumbnail for [[banner.title]]" style="width:50px; height:50px;" sizing="cover"  /></iron-image>
        </template>
      </iron-swiper>
    </template>

  </template>

  <script>
    /**
     * `uvalib-banner`
     *
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class UvalibBanners extends UvalibUiElement {
      static get is() { return 'uvalib-banners'; }
      static get properties() {
        return Object.assign(super.properties,{
          controls: {
            type: Boolean,
            computed: '_moreThanOne(banners)'
          },
          banners: Array,
          selected: Number
        });
      }
      _showThumbs(smallScreen, banners) {
        return (!smallScreen && this._moreThanOne(banners));
      }
      _moreThanOne(banners) {
        return (Array.isArray(banners) && banners.length>1);
      }
      //Concat the this elements template with the parents
      static get template() {
        var parentTemplate = UvalibUiElement.template.cloneNode(true);
        var childTemplate = Polymer.DomModule.import('uvalib-banners', 'template');
        parentTemplate.content.insertBefore(childTemplate.content,null);
        return parentTemplate;
      }
    }

    window.customElements.define(UvalibBanners.is, UvalibBanners);
  </script>
</dom-module>
