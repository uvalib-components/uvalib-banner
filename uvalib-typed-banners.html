<link rel="import" href="../uvalib-models/uvalib-model-query.html">
<link rel="import" href="../uva-swiper/uva-swiper.html">
<link rel="import" href="../uvalib-images/uvalib-image.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">

<dom-module id="uvalib-typed-banners">

  <template>

    <style is="custom-style">
      :host {
        display: block;
        height: 100%;
        @apply(--layout-vertical);
      }
      #container {
        @apply(--layout-flex);
        @apply(--layout-vertical);
      }
      .main {
        @apply(--layout-flex);

        --uva-swiper-slide: {
          @apply(--layout-vertical);
          font-family: Franklin Gothic,sans-serif;
          font-style: normal;
          font-weight: 400;
          font-size: 16px;
          line-height: 25px;
        };
        --uva-swiper-slide-style1: {
          @apply(--layout-flex);
        };
        --uva-swiper-slide-style2: {
          padding: 10px;
        };
      }
      .nav {
        height: 200px;
        --uva-swiper-slide: {
          filter: blur(1px);
        };
        --uva-swiper-slide-active: {
          filter: none;
        };
        --uva-swiper-slide-hover: {
          filter: none;
        };
      }
      /*
      .full-entity {
        width: 100%;
        @apply(--layout-vertical);
      }
      .full-entity uvalib-image {
        display: block;
        height: 100%;
        @apply(--layout-flex);
      }
      .full-entity .description {
        height: 100px;
      }
      */

    </style>
    <uvalib-model-query data="{{items}}" content-type="{{contentType}}" order-by="{{matchKey}}" equal-to="{{matchValue}}"></uvalib-model-query>
    <div id="container">
      <uva-swiper class="main" a11y keyboard-control navigation-buttons$="{{buttons}}" selected="{{selected}}">
          <template is="dom-repeat" items="[[items]]" as="image">
            <div class="full-entity">
              <uvalib-image class="style1" alt$="{{image.title}}" uuid$="{{image.image.uuid}}" sizing="contain"></uvalib-image>
              <div class="style2 description">
                <div class="desc-wrapper" inner-h-t-m-l="{{image.body}}"></div>
              </div>
            </div>
          </template>
      </uva-swiper>

      <template is="dom-if" if="{{thumbs}}">
        <uva-swiper selected="{{selected}}" class="nav" touch-ratio="0.2" slide-to-clicked-slide centered-slides slides-per-view="8">
        <!--<uva-swiper class="nav" a11y keyboard-control slide-to-clicked-slide centered-slides slides-per-view="auto" selected="{{selected}}">-->
            <template is="dom-repeat" items="[[items]]" as="image">
                <uvalib-image thumb alt$="{{image.title}}" uuid$="{{image.image.uuid}}" sizing="crop"></uvalib-image>
            </template>
        </uva-swiper>
      </template>

    </div>
  </template>

  <script>
    Polymer({
      is: 'uvalib-typed-banners',

      properties: {
        thumbs: {
          type: Boolean,
          value: false
        },
        buttons: {
          type: Boolean,
          value: false
        },
        mediumScreen: {
          type: Boolean,
          value: false
        },
        largeScreen: {
          type: Boolean,
          value: false
        },
        _bannersBuffer: {
          type: Array,
          value: function(){
            return [];
          },
          observer: "_bannersBufferChange"
        },
        _banners: {
          type: Array,
          value: function(){
            return [];
          }
        },
        contentType: {
          type: String,
          value: "mediaobjects"
        },
        matchKey: {
          type: String,
          value: null
        },
        matchValue: {
          type: String,
          value: null
        },
        items: {
          type: Array,
          value: function(){return [];}
        }
      },
      _bannersBufferChange: function(){
        this.debounce('bannerbounce', function(){
          if (this._bannersBuffer && this._bannersBuffer.length >= 1) {
            this.set('_banners', this._bannersBuffer);
          }
        }, 500);
      },
    });
  </script>
</dom-module>
