<link rel="import" href="../uvalib-models/uvalib-model-query.html">
<link rel="import" href="../uva-swiper/uva-swiper.html">
<link rel="import" href="../uvalib-images/uvalib-image.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">

<dom-module id="uvalib-typed-banners">

  <template>

    <style is="custom-style">
      :host {
        display: block;
        height: 100%;
      }
      #container {
        height: 100%;
        @apply(--layout-vertical);
      }
      uva-swiper.main {
        @apply(--layout-flex);
      }
      .main uvalib-image {
/*        background-color: white; */
      }
      uva-swiper.nav {
        height: 100px;
      }
      .nav uvalib-image {
        width: 130px;
      }
      .main uvalib-image {
        width: 100%;
      }
      .swiper-wrapper {
        @apply(--layout-vertical);
      }
      .full-entity {
        width: 100%;
/*        height: 100%; */
        @apply(--layout-vertical);
      }
      .full-entity uvalib-image {
        @apply(--layout-flex);
      }
      .description {
        position: relative;
        font-size: 1.2em;
        width: 100%;
        height: var(--uvalib-banner-desc-height);
        bottom: -30px; */
        color: white;
      }
      .desc-wrapper {
        position: relative;
        height: var(--uvalib-banner-desc-height);
        padding-bottom: 50px;
        padding-left: 20px;
        padding-right: 20px;
        padding-top: 10px;
        top: -50px;
        color: white;
        background-color:rgba(0, 0, 0, 0.5);
      }
      .nav {
        background-color:rgba(0, 0, 0, 0.5);
        position: relative;
        top: -20px;
      }
    </style>
    <uvalib-model-query data="{{_images}}" content-type="mediaobjects" order-by="association" equal-to="100objectsCarousel"></uvalib-model-query>
    <div id="container">
      <uva-swiper class="main" a11y keyboard-control navigation-buttons$="{{buttons}}" selected="{{selected}}">
          <template is="dom-repeat" items="[[_images]]" as="image">
            <div class="full-entity">
              <uvalib-image alt$="{{image.title}}" uuid$="{{image.image.uuid}}" sizing="contain"></uvalib-image>
              <div class="description">
                <div class="desc-wrapper" inner-h-t-m-l="{{image.body}}"></div>
              </div>
            </div>
          </template>
      </uva-swiper>
      <template is="dom-if" if="{{thumbs}}">
        <uva-swiper class="nav" a11y keyboard-control slide-to-clicked-slide centered-slides slides-per-view="auto" selected="{{selected}}">
            <template is="dom-repeat" items="[[_images]]" as="image">
                <uvalib-image thumb alt$="{{image.title}}" uuid$="{{image.image.uuid}}" sizing="crop" style=""></uvalib-image>
            </template>
        </uva-swiper>
    </template>
    </div>
  </template>

  <script>
    Polymer({
      is: 'uvalib-typed-banners',

      properties: {
        thumbs: {
          type: Boolean,
          value: false
        },
        buttons: {
          type: Boolean,
          value: false
        },
        mediumScreen: {
          type: Boolean,
          value: false
        },
        largeScreen: {
          type: Boolean,
          value: false
        },
        _bannersBuffer: {
          type: Array,
          value: function(){
            return [];
          },
          observer: "_bannersBufferChange"
        },
        _banners: {
          type: Array,
          value: function(){
            return [];
          }
        }
      },
      _bannersBufferChange: function(){
        this.debounce('bannerbounce', function(){
          if (this._bannersBuffer && this._bannersBuffer.length >= 1) {
            this.set('_banners', this._bannersBuffer);
          }
        }, 500);
      },
    });
  </script>
</dom-module>
